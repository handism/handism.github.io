---
title: AWS Certified SysOps Administrator - Associate認定の対策
tags: [AWS, Infrastructure]
image: cloud-fantasy.webp
---


## 経緯

この度、`AWS Certified SysOps Administrator - Associate`を受験すべく対策を行っていく。長いので以下`SOA`と呼ぶ。


## SOA試験について
* 試験時間130分、受験料150USD
* 試験方法はPearson VUE テストセンターまたはオンラインでの監督付き試験
* 本来は「試験ラボ」というフェーズがあるらしいけど、2023/03/28以降は一時的に含まれなくなっている
* 合格スコアは`720 / 1000`
* 試験対象は「クラウド
オペレーションの役割を担うシステムアドミニストレーター」で、取得すると、「AWS でのワークロードのデプロイ、管理、運用の経験
」が証明される

SOAの試験内容は以下の通りとのこと。

```
第 1 分野: モニタリング、ロギング、および修復 (採点対象コンテンツの 20%)
第 2 分野: 信頼性と事業の継続性 (採点対象コンテンツの 16%)
第 3 分野: デプロイ、プロビジョニング、およびオートメーション (採点対象コンテンツの 18%)
第 4 分野: セキュリティとコンプライアンス (採点対象コンテンツの 16%)
第 5 分野: ネットワークとコンテンツ配信 (採点対象コンテンツの 18%)
第 6 分野: コストとパフォーマンスの最適化 (採点対象コンテンツの 12%)
```


## 試験対象のサービス

SOAの試験対象のサービスは、以下PDFに列記されているためそれごとに学んでいったほうが効率的。逆に対象外のサービスも列記されている。

https://d1.awsstatic.com/ja_JP/training-and-certification/docs-sysops-associate/AWS-Certified-SysOps-Administrator-Associate_Exam-Guide.pdf

デプロイやプロビジョニングの自動化…と聞いて真っ先に思い浮かぶのは`AWS CodePipeline`、`AWS CodeBuild`、`AWS CodeCommit`、`AWS CodeDeploy`らへんだったが、本試験では対象外とのこと。



### 分析

#### Amazon OpenSearch Service
- OpenSearchとは、ElasticsearchとKibanaの最後のALv2バージョンからフォークを作成したもの。Amazonだけじゃなく、いろんな企業や個人が参画して更新し続けている
  - マネージドのため構築・管理コストは低い
  - ユーザー管理はIAMで行う、もしくはOpenSearch側で独自のユーザー管理も可
  - このサービス自体のログ、セキュリティ、バックアップなどが考慮不要
  - CFnに対応のため他環境や他サービスへの横展開がしやすい
  - インスタンスを夜間に停止して利用料金を削減みたいなのができない
    - 例えば、開発環境、総合テスト環境だけ日中のみ稼働にし、本番環境だけ24時間稼働にするとか
  - インスタンス時間、ストレージの量、転送されるデータで課金される
    - 自動スナップショットは無料
    - 開発環境ではt3.small.search、本番環境ではt3.medium.searchが良さそう。大体毎月6,351円くらい？
- Amazon OpenSearch Serverless
  - Serviceの方と比べて以下の運用タスクを削減可能
    - データライフサイクルの管理
    - バージョンアップグレード、ソフトウェアアップデート
    - クラスターリソースのモニタリング
  - Serviceの方と比べてServerless固有の制限がある（アラート、異常検知、kNNに非対応？）
  - 最低コストがめっちゃ高い
    - OpenSearch Compute Unit（OCU）ごとに課金で、最低4OCUが必要なので毎月146,292円くらいはかかる


### アプリケーション統合

#### Amazon EventBridge


#### Amazon Simple Notification Service (Amazon SNS)
プッシュ型のメッセージングサービス。


#### Amazon Simple Queue Service (Amazon SQS)
メッセージキューサービス。実は最も古いAWSサービス。

- `Standard`：順番を保証しない。
- `FIFO`：二重配信の排除も順番も保証

- `可視性タイムアウト`：重複を防ぐ
- `遅延キュー`：時間整合性を保つ
- `デッドレターキュー`：問題のあるメッセージを隔離する


### クラウド財務管理

#### AWS Cost and Usage Report


#### AWS Cost Explorer


#### Savings Plans


### コンピューティング

#### AWS Auto Scaling
スケーリングクールダウン：オートスケーリングが連続実行されないように設定する待ち時間。デフォルトは300秒。


#### Amazon EC2

* 購入オプション
  * `リザーブドインスタンス`：オンデマンドよりもかなり安い。ただし、3年とか縛りで途中でキャンセルができない
  * `スケジュールドリザーブドインスタンス`：バッチ処理とかに
  * `オンデマンドインスタンス`：EC2のデフォルト
  * `スポットインスタンス`：オンデマンドよりも安いけど、途中で中断されるリスクがある。AZの空き容量によって値段が変動する
  * `ハードウェア専有インスタンス`：セキュリティ的なメリットはあるが、料金が高い
* インスタンスファミリー
  - 汎用：`T,M`
  - コンピューティング最適化：`C`
  - メモリ最適化：`X,R`
  - 高速コンピューティング：`P,G,F`
  - ストレージ最適化：`H,I,D`


#### Amazon EC2 Auto Scaling


#### Amazon EC2 Image Builder


#### AWS Lambda
- コードが実行されるごとに課金
- 無限実行されないようタイムアウト設定がある。デフォルト3秒
- リクエストあたりの最大実行時間は900秒
- `Java,Node.js,C#,Python,Go,PowerShell,Ruby`に対応


### データベース

#### Amazon Aurora
PostgreSQLおよびMySQL互換のデータベースエンジン。AWS独自開発なのでイチオシのため、試験問題の答えになる可能性が高い。


#### Amazon DynamoDB
マネージド型のKey-Value型データベース。自動的に3つのAZにデータ保存で高可用性がある。


#### Amazon ElastiCache
インメモリキャッシュシステムのPaaS。かなり高価だけど、RDSの応答速度をかなりアップできる。
 
- `Redis`：複雑なデータに対応。シングルスレッドで可用性が高い。Pub/Sub機能を提供
- `Memcached`：高パフォーマンスとマルチスレッド対応が可能


#### Amazon RDS


### デベロッパーツール

#### AWS のツールと SDK



### マネジメントとガバナンス


#### AWS CLI


#### AWS CloudFormation

AWSリソースのデプロイ自動化としては`AWS CloudFormation`が便利。Infrastructure as Code（IaC）という概念があり、インフラをコードで管理することで様々なメリットがある。

* 環境ごとに`手動によるミスなく`同じ内容のインフラを構築でき、環境ごとに差異を表現することも可能
* システムごとにコードを使いまわすことで設計・構築の`効率化`ができる
* コードを`Git`や`AWS CodeCommit`などで管理することによって
`履歴管理`ができ、差分も取りやすいので`レビューが容易`

CloudFormationには`リソース`、`テンプレート`、`スタック`の概念がある。

| リソース | テンプレート | スタック |
| --- | --- | --- |
| 構築対象のAWSインフラの単位のこと。 | インフラ構築の手続き内容を記載したコードのこと。YAMLやJSONで記載する。 | テンプレートを読み込ませて構築したリソースの集合体のこと。 |


どんなサービス？

- AWSのインフラをコード（JSONやYAML）で管理できるサービス。考え方的にはIaC（Infrastructure as Code）
- AWSの中では「プロビジョニング」に相当する
- 使用料は無料
- リソース間の依存関係は、CFが自動で判別してくれる
- 嬉しい点
    - 昔のようにデプロイ手順書などを作らなくて良い
    - 人の手によるインフラ構築のミスが減る
    - テンプレートをGitで管理できる

スタック

- テンプレートから作成されるリソースの集合体のこと。この単位でリソースを管理可能
- テンプレートを修正した場合、作ったスタックに後から再度テンプレートを適用でき、差分だけが適用されるから安心
- スタックを削除することで、作られたリソースも自動的に削除される

テンプレート

- JSONとYAMLが使えて、YAMLのがコメント（#）をつけられるのでおすすめ
- リソースの記載は必須
- Descriptionは日本語入れるとスタック上で文字化けする…
- 組み込み関数：!Refなど
- 場合分けで文字列を使い分ける
    - Mappings:
    - !FindInMap
- パラメータを選択式にする
    - AllowedValues:

使い方

- YAMLを作ったら、AWSコンソールで「スタックの作成」をして、YAMLをアップロードする。その後進めていくと勝手にリソースが作られる
- スタックの削除をすることで、作られたリソースも自動的に削除される
- スタック間で値を参照することができる
    - 被参照側がOutputs:にExport属性とName属性を
    - 参照側はFn::ImportValueで参照


#### AWS CloudTrail
AWSのAPI呼び出しを記録してロギングするサービス。監査証跡に使える。データイベントと管理イベントのログを記録できる。

#### Amazon CloudWatch
AWS上のリソースやアプリケーションのモニタリングサービス。

* `ロググループ`：
* `ログストリーム`：ロググループに所属できる

#### AWS Compute Optimizer


#### AWS Config


#### AWS Control Tower


#### AWS Health Dashboard


#### AWS License Manager


#### AWS マネジメントコンソール


#### AWS Organizations


#### AWS Service Catalog


#### AWS Systems Manager


#### AWS Trusted Advisor
AWSの適切な利用をサジェストするツール。例えば、使用率が高いEC2インスタンスを全て検出するなどができる。



### 移行と転送

#### AWS DataSync


#### AWS Transfer Family


### ネットワークとコンテンツ配信

#### Amazon CloudFront
CDNサービス。キャッシュサービス。

- `エッジロケーション`：コンテンツ配信を行うための拠点となる設備。CloudFrontの拠点


#### Elastic Load Balancing (ELB)
ハードウェアの制約を受けず、自動的にスケーリングする。CloudWatch、Route53、AWS Auto Scalingなどと連携できる。

* `ALB`：レイヤー7（アプリケーション層）で動作するロードバランサー。HTTP、HTTPSに対応。
* `NLB`：レイヤー4（トランスポート層）で動作する。TCP/UDP/TLSに対応。低レイテンシーという利点があり、内部向けの通信でよく利用される。
* `リスナー`：外部からアクセスするプロトコルとポートを指定して、接続リクエストをチェック。
* `リスナールールとアクション`：リスナーに基づき異なるアクションを設定できる。
* `ターゲットとターゲットグループ`：トラフィックの転送先のリソースやエンドポイント。
* `SSLターミネーション`：
* `スティッキーセッション`：同一セッション中のユーザーリクエストを同じリソースに振り分ける。ELBがCookieを発行することによって実現。
* `Pre-warming（暖機運転）`：ELBを事前にスケールさせておく操作のこと。


#### AWS Global Accelerator


#### Amazon Route 53
ドメインネームシステムを提供するサービス。唯一100%のSLAを保証。

AWSの各サービス間連携は、DNSホスト名（FQDN）を使うことで拡張性や運用性が高まる。

ドメインレジストラやフォールトトレラントアーキテクチャ（DNSフェイルオーバー）の役割も果たす。


#### AWS Transit Gateway


#### Amazon VPC
AWS上にプライベートネットワーク空間を提供するサービス。ハードウェアや配線を意識せずに簡単にプライベートネットワークを構築できる。

オンプレのデータセンターとも、AWS Direct Connectで接続できる。大事なリソースは、プライベートサブネット内に配置し、NATゲートウェイでアウトバウンドのアクセスのみ可能にして必要に応じてアクセスするようにする。

デフォルトで一つのリージョンに作成できるサブネットの上限数は200。

マルチAZ構成も簡単にできる。実際はAZごとにサブネットを作り、その中にFC2などを置く。

* インターネットゲートウェイ：VPCとインターネットを繋げるもの。
* NATゲートウェイ：プライベートIPアドレスをパブリックIPアドレスを変換する機能を持つ。
* ENI：VPC内部のIPアドレスを持つ仮想的なコンポーネント。オンプレでいうNICのこと。例えばEC2インスタンスにアタッチすることでネット接続できるようになる。
* EIP：固定化されたパブリックIPアドレスを割り当てるコンポーネント。Webサーバなどにアタッチして利用する。アタッチしているインスタンスが停止している間に課金されるので、止めたらすぐ解放すると良い。
* VGW：
* VPCエンドポイント：インターネットゲートウェイを経由せずに、VPC内からVPC外にあるサービスと接続する場合に間に噛ませる。
* セキュリティグループ：インスタンス単位の通信制御に利用される仮想ファイアウォール。ホワイトリスト方式。行き通信を許可すれば戻り通信は自動で許可。ステートフルな制御が可能。
* ネットワークACL：サブネット単位の通信制御に利用される仮想ファイアウォール。ブラックリスト方式。行き・戻り通信で明示的な通信許可が必要。ステートレス。
* VPCピアリング：異なるVPC同士を接続するサービス。
* VPCフローログ：CloudWatch LogsとS3に発行できる。トラシューなどに使える。
* 予約IPアドレス：CIDRブロックの最初の4つのIPアドレス、最後のIPアドレス
* VPC Reachablity Analyzer：
* AWS PrivateLink：セキュリティ対策に使える。
* Gateway Load Balancerエンドポイント：
* AWS PrivateLink for Amazon S3：
* AWS Transit Gateway：vpc管理を一元化できてシンプルな構成になる。


#### AWS VPN


### セキュリティ、アイデンティティ、コンプライアンス

#### AWS Certificate Manager (ACM)


#### Amazon Detective


#### AWS Directory Service


#### AWS Firewall Manager


#### Amazon GuardDuty


#### AWS Identity and Access Management (IAM)

- IAMユーザー：ログインと特定の権限を付与
- IAMグループ：グループ内のユーザーに対して特定の権限を付与（人間に対してはこれがベストプラクティス）
    - 基本的にはユーザーよりこれを使う
- IAMロール：特定のユーザーやAWSサービスに対し権限を委任（リソース同士の認証・認可はこれがベストプラクティス）
    - 一時的なセキュリティ認証情報を取得するときに使用
    - STSで一時的にトークンを払い出すと良い。
- IAMポリシー：どのリソースにどの操作を許可するか権限を定義
    - これを作成して上の3つにアタッチする


#### AWS Identity and Access Management Access Analyzer


#### Amazon Inspector


#### AWS Key Management Service (AWS KMS)


#### AWS Secrets Manager


#### AWS Security Hub


#### AWS Shield


#### AWS WAF



### ストレージ

#### AWS Backup


#### Amazon Elastic Block Store (Amazon EBS)
- EC2のインスタンスから利用するストレージ。外付けディスクみたいなもん。
- 基本的には汎用SSDを選ぶ。性能要件を満たさなければならないときはプロビジョンドIOPS。でもデータのIOPSごとに課金が発生。

- ボリュームの作成時に暗号化に設定可能。既存のボリュームを暗号化ボリュームに変更するには作業が必要で面倒。

ボリュームタイプ

- 汎用SSD
- プロビジョンドIOPS SSD：最もパフォーマンスが高い代わりにIOPS数課金
- スループット最適化HDD：高いスループットかつ安価
- コールドHDD：低スループットかつ安価
- マグネティック：旧世代

#### Amazon Elastic File System (Amazon EFS)

汎用モード（レイテンシー重視）、最大I/Oモード（スループット重視）。フルマネージドサービス。自動的に容量を拡張できる。

- スケーラブルなファイルストレージ。

#### Amazon FSx
for Windowsは、WindowsのSMBプロトコルに対応している。

#### Amazon S3
高耐久・大容量のオブジェクトストレージサービス。

- `バケット`：
- `オブジェクト`：ファイルとメタデータを合わせた概念
- 最大99.999999999%の耐久性と99.99%の可用性。
- RESTやSOAPといったシンプルなWebサービスインタフェースで行われる。
- S3のデータは「強い一貫性」が保証されている。
- `Design for Failure`：障害が発生してもサービスが継続できるようなシステム設計
- `MFA Delete`：S3の削除時に、ワンタイムパスワードを求めて誤削除防止
* ストレージクラス
  - `標準`：耐久性が高い
  - `標準ー低頻度アクセス`：耐久性が高く、安いけど、データ読み出し容量に対しても課金される
  - `Glacier`：耐久性が高く、最も安価だけど、データ取り出しに3-5時間
  - `1ゾーンー低頻度アクセス`：耐久性が低い代わりに安い
  - `Intelligent-Tiering`：オブジェクトへのアクセス頻度に応じてコスト最適に自動的使い分け

#### Amazon S3 Glacier
あまり使わないファイルを入れておく。その分S3よりも安い。S3にファイルが復元された時、イベントでメールで通知を送信することができる。

- 氷河の名前を冠したデータの長期保存向けのサービス。S3の5分の1のコストですむ。

#### AWS Storage Gateway